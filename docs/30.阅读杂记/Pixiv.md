# p 站 api 现状

当前 p 站无法通过移动端 api 登陆，web 端也添加了各种认证，直接使用获取到的 token 去传递将是最简便的办法

<https://gist.github.com/ZipFile/c9ebedb224406f4f11845ab700124362>
<https://github.com/eggplants/get-pixivpy-token>
<https://github.com/Floaterest/pixiv.ts>

# 如果想写个小的收集工具，需要如下几部分

登陆获取 Token 的部分（docker 外挂，解析文本返回，服务 1）

移动端 api 调用的服务（拆分请求部分，与实际调用 api 的部分，依赖服务 1 保证自身的可用性，服务 2）

具体的业务 （依赖服务 2）

介于这个复杂度不高，写在同一个服务中

# 实际使用

Api 是移动端的
使用两个 Token 一个 refresh 一个 access
获取的方式基本是通过无头浏览器去取，问题在于有谷歌的人机验证
简单的搞就是先用浏览器通过验证再通过无头模式获取，看看这个能不能拆分或者简单化一些

# 计划

还是基于 koa ts 尽量复用以前的工程结构，登陆和刷新 token 从 Api 中拆出来，其他 Api 用到哪个拆哪个
榜单，搜索，主要先这两个
模块注意拆分和隔离
使用 ORM
表设计区分开，考虑清除

## 1.0.0

1.  每日拉取榜单保存
2.  展示界面。
    2.1 榜单展示  
     2.1.1 爬取中返回稍等，支持不缓存直接展示  
     2.1.2 自己提供图片反代  
     2.1.3 支持按 tag 过滤，聚合去重展示  
    2.2 Token 设置的部分
    2.3 可控制什么时候爬取哪几类  
     2.3.1 调度列表，可以创建爬取历史的
